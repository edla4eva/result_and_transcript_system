<div class="wikidoc"><h1>Description</h1>  <p>Fixing bugs and adding new features is a part of developing software applications. From my experience, sending application updates to users is also a critical part of developing applications, especially when the user has no advanced knowledge of computers. In the Internet era today, the software developer must make application deployment and updating easier and often makes automatic application updates to do this.I already searched through the internet on this topic, but not much seems suited to my needs. So, I tried to create one myself. This sample application is developed in C# as a library with the project name “AutoUpdater”. The DLL “AutoUpdater” can be used in a C# Windows application(WinForm and WPF).</p>  <h1>About the features </h1>  <h3>There are certain features about the AutoUpdater: </h3>  <p>1,Easy to implement and use.    <br>2,Application automatic re-run after checking update.     <br>3,Update process transparent to the user .     <br>4,To avoid blocking the main thread using multi-threaded download.     <br>5,Ability to upgrade the system and also the auto update program.     <br>6,A code that doesn't need change when used by different systems and could be compiled in a library.     <br>7,Easy for user to download the update files.</p>  <h1>The following UI</h1>  <p>There are two pages and very pretty simple,just as follows:</p>  <p><a href="http://download.codeplex.com/download?ProjectName=AutoUpdater&DownloadId=158594"><img style="border-bottom:0px;border-left:0px;display:inline;border-top:0px;border-right:0px" title="2010-10-13 18-05-02" border=0 alt="2010-10-13 18-05-02" src="http://download.codeplex.com/download?ProjectName=AutoUpdater&DownloadId=158595" width=760 height=442></a> </p>  <p> Figure 1</p>  <p><a href="http://download.codeplex.com/download?ProjectName=AutoUpdater&DownloadId=158596"><img style="border-bottom:0px;border-left:0px;display:inline;border-top:0px;border-right:0px" title="2010-10-13 18-05-41" border=0 alt="2010-10-13 18-05-41" src="http://download.codeplex.com/download?ProjectName=AutoUpdater&DownloadId=158597" width=762 height=472></a> </p>  <p>Figure 2</p>  <h1>How to use?</h1>  <p>In the program that you want to be auto updateable, you just need to call the AutoUpdate function in the Main procedure. The AutoUpdate&#160; function will check the version with the one read from a file located in a Web Site/FTP. If the program version is lower than the one read the program downloads the auto update program and launches it and the function returns True, which means that an auto update will run and the current program should be closed. The auto update program receives several parameters from the program to be updated and performs the auto update necessary and after that launches the updated system.</p>  <pre>      #region check and download <span style="color:#0000ff">new</span> version program
      <span style="color:#0000ff">bool</span> bHasError = <span style="color:#0000ff">false</span>;
      IAutoUpdater autoUpdater = <span style="color:#0000ff">new</span> AutoUpdater();
      <span style="color:#0000ff">try</span>
      {
          autoUpdater.Update();
      }
      <span style="color:#0000ff">catch</span> (WebException exp)
      {
          MessageBox.Show(&quot;<span style="color:#8b0000">Can not find the specified resource</span>&quot;);
          bHasError = <span style="color:#0000ff">true</span>;
      }
      <span style="color:#0000ff">catch</span> (XmlException exp)
      {
          bHasError = <span style="color:#0000ff">true</span>;
          MessageBox.Show(&quot;<span style="color:#8b0000">Download the upgrade file error</span>&quot;);
      }
      <span style="color:#0000ff">catch</span> (NotSupportedException exp)
      {
          bHasError = <span style="color:#0000ff">true</span>;
          MessageBox.Show(&quot;<span style="color:#8b0000">Upgrade address configuration error</span>&quot;);
      }
      <span style="color:#0000ff">catch</span> (ArgumentException exp)
      {
          bHasError = <span style="color:#0000ff">true</span>;
          MessageBox.Show(&quot;<span style="color:#8b0000">Download the upgrade file error</span>&quot;);
      }
      <span style="color:#0000ff">catch</span> (Exception exp)
      {
          bHasError = <span style="color:#0000ff">true</span>;
          MessageBox.Show(&quot;<span style="color:#8b0000">An error occurred during the upgrade process</span>&quot;);
      }
      <span style="color:#0000ff">finally</span>
      {
          <span style="color:#0000ff">if</span> (bHasError == <span style="color:#0000ff">true</span>)
          {
              <span style="color:#0000ff">try</span>
              {
                  autoUpdater.RollBack();
              }
              <span style="color:#0000ff">catch</span> (Exception)
              {
                 <span style="color:#008000">//Log the message to your file or database</span>
              }
          }
      }
      #endregion</pre>

<p>that’s it,just enjoy it!</p>

<h1>About the solutions</h1>

<p>The application is pretty simple,just contains two pages and some helper classes.</p>

<p><a href="http://download.codeplex.com/download?ProjectName=AutoUpdater&DownloadId=158598"><img style="border-bottom:0px;border-left:0px;display:inline;border-top:0px;border-right:0px" title=autoupdatersolution border=0 alt=autoupdatersolution src="http://download.codeplex.com/download?ProjectName=AutoUpdater&DownloadId=158599" width=652 height=531></a> </p>

<p>Figure 3</p>

<h1>License</h1>

<p>This article has no explicit license attached to it but may contain usage terms in the article text or the download files themselves. If in doubt please contact the author via the discussion board below.</p>

<h1>About the Author</h1>

<ul>
  <li>Author: 圣殿骑士（Knights Warrior） </li>

  <li>Email:&#160; <a href="mailto:KnightsWarrior@msn.com">KnightsWarrior@msn.com</a> </li>

  <li>Website:&#160; <a href="http://www.cnblogs.com/KnightsWarrior/">http://www.cnblogs.com/KnightsWarrior/</a>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <a href="http://knightswarrior.blog.51cto.com/">http://knightswarrior.blog.51cto.com/</a> </li>

  <li>Create Date: 5/8/2010 </li>
</ul>

<p></p>

<p></p>

<p></p>

<p>you can download the tool via <a title="http://autoupdater.codeplex.com/" href="http://autoupdater.codeplex.com/">http://autoupdater.codeplex.com/</a>,If in doubt please contact me,Thanks!</p></div><div class="ClearBoth"></div>